<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Leaderboard</title>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding: 20px; background:#f7f9fc; color:#111; }
  .card { background:white; border-radius:12px; padding:18px; box-shadow: 0 6px 20px rgba(20,30,40,0.06); max-width:900px; margin:auto; }
  h1 { margin:0 0 10px 0; font-size:1.6rem; }
  table { width:100%; border-collapse: collapse; margin-top:12px; }
  th, td { text-align:left; padding:8px 10px; border-bottom: 1px solid #eee; }
  th { color:#555; font-size:0.9rem; }
  td.score { font-weight:700; width:120px; text-align:right; }
  .muted { color:#777; font-size:0.9rem; }
  .controls { display:flex; gap:8px; align-items:center; margin-top:10px; }
  .small { font-size:0.85rem; padding:6px 8px; border-radius:8px; }
</style>
</head>
<body>
  <div class="card">
    <h1>Leaderboard</h1>
    <div class="controls">
      <div class="muted" id="lastUpdated">â€”</div>
      <button id="refreshBtn" class="small">Refresh</button>
      <label class="muted" style="margin-left:auto;">
        Show top <select id="limit">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="all" selected>All</option>
        </select>
      </label>
    </div>

    <table id="leaderboard">
      <thead>
        <tr><th>Rank</th><th>Name</th><th class="score">Score</th><th>Timestamp (ET)</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<script>
// ------------------------- CONFIG -------------------------
const WEB_APP_URL = "YOUR_WEB_APP_URL_HERE"; 
// -----------------------------------------------------------

const $ = sel => document.querySelector(sel);
const tbody = $("#leaderboard tbody");
const lastUpdated = $("#lastUpdated");
const limitSelect = $("#limit");

// Fetch leaderboard
async function fetchLeaderboard() {
  lastUpdated.textContent = "Loading...";
  try {
    const res = await fetch(WEB_APP_URL);
    const data = await res.json();
    if (!data.ok) throw new Error(data.error || "Bad response");

    let rows = data.rows || [];

    rows = rows.map(r => ({
      name: r.name || "",
      score: typeof r.score === "number" ? r.score :
             (isFinite(Number(r.score)) ? Number(r.score) : 0),
      timestamp: r.timestamp || ""
    }));

    // Sort: sc
